var InfiniteCanvas=function(t){var n={};function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)e.d(i,r,function(n){return t[n]}.bind(null,r));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){var{InfiniteCanvas:i}=e(1);t.exports=i},function(t,n,e){"use strict";e.r(n);var i=function(){function t(t){this.viewBox=t}return t.prototype.restore=function(){this.viewBox.restoreState()},t.prototype.save=function(){this.viewBox.saveState()},t}(),r=function(){function t(t,n,e,i,r,o){this.a=t,this.b=n,this.c=e,this.d=i,this.e=r,this.f=o,this.scale=Math.sqrt(t*i-n*e)}return t.prototype.getRotationAngle=function(){var t=this.a/this.scale,n=this.b/this.scale;if(0===t)return n>0?Math.PI/2:3*Math.PI/2;var e=Math.atan(n/t);return t>0?n>0?e:0===n?0:2*Math.PI+e:n>0?Math.PI+e:0===n?Math.PI:Math.PI+e},t.prototype.apply=function(t){return{x:this.a*t.x+this.c*t.y+this.e,y:this.b*t.x+this.d*t.y+this.f}},t.prototype.before=function(n){return new t(n.a*this.a+n.c*this.b,n.b*this.a+n.d*this.b,n.a*this.c+n.c*this.d,n.b*this.c+n.d*this.d,n.a*this.e+n.c*this.f+n.e,n.b*this.e+n.d*this.f+n.f)},t.prototype.equals=function(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f},t.prototype.inverse=function(){var n=this.a*this.d-this.b*this.c;if(0==n)throw"error calculating inverse: zero determinant";return new t(this.d/n,-this.b/n,-this.c/n,this.a/n,(this.c*this.f-this.d*this.e)/n,(this.b*this.e-this.a*this.f)/n)},t.translation=function(n,e){return new t(1,0,0,1,n,e)},t.scale=function(n){return new t(n,0,0,n,0,0)},t.zoom=function(n,e,i,r,o){var a=1-i;return void 0!==r?new t(i,0,0,i,n*a+r,e*a+o):new t(i,0,0,i,n*a,e*a)},t.translateZoom=function(n,e,i,r,o,a,s,c){var h=i-n,u=r-e,p=h*h+u*u;if(0===p)throw new Error("divide by 0");var f=s-o,l=c-a,y=f*f+l*l,d=Math.sqrt(y/p);return t.zoom(n,e,d,o-n,a-e)},t.rotation=function(n,e,i){var r=Math.cos(i),o=Math.sin(i),a=1-r;return new t(r,o,-o,r,n*a+e*o,-n*o+e*a)},t.translateRotateZoom=function(n,e,i,r,o,a,s,c){var h=i-n,u=r-e,p=h*h+u*u;if(0===p)throw new Error("divide by 0");var f=s-o,l=c-a,y=n*r-e*i,d=i*h+r*u,v=n*h+e*u,g=(h*f+u*l)/p,S=(h*l-u*f)/p;return new t(g,S,-S,g,(o*d-s*v-y*l)/p,(a*d-c*v+y*f)/p)},t.identity=new t(1,0,0,1,0,0),t}(),o=function(){function t(t){this.viewBox=t}return t.prototype.getTransform=function(){if(DOMMatrix){var t=this.viewBox.state.current.transformation;return new DOMMatrix([t.a,t.b,t.c,t.d,t.e,t.f])}},t.prototype.resetTransform=function(){this.viewBox.changeState(function(t){return t.setTransformation(r.identity)})},t.prototype.rotate=function(t){this.viewBox.changeState(function(n){return n.addTransformation(r.rotation(0,0,t))})},t.prototype.scale=function(t,n){this.viewBox.changeState(function(e){return e.addTransformation(new r(t,0,0,n,0,0))})},t.prototype.setTransform=function(t,n,e,i,o,a){var s,c,h,u,p,f;"number"==typeof t?(s=t,c=n,h=e,u=i,p=o,f=a):void 0!==t.a?(s=t.a,c=t.b,h=t.c,u=t.d,p=t.e,f=t.f):(s=t.m11,c=t.m12,h=t.m21,u=t.m22,p=t.m41,f=t.m42),this.viewBox.changeState(function(t){return t.setTransformation(new r(s,c,h,u,p,f))})},t.prototype.transform=function(t,n,e,i,o,a){this.viewBox.changeState(function(s){return s.addTransformation(new r(t,n,e,i,o,a))})},t.prototype.translate=function(t,n){this.viewBox.changeState(function(e){return e.addTransformation(r.translation(t,n))})},t}(),a=function(){},s=function(){function t(t){this.viewBox=t}return Object.defineProperty(t.prototype,"fillStyle",{set:function(t){this.viewBox.changeState(function(n){return n.setFillStyle(t)})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeStyle",{set:function(t){this.viewBox.changeState(function(n){return n.setStrokeStyle(t)})},enumerable:!0,configurable:!0}),t.prototype.createLinearGradient=function(t,n,e,i){},t.prototype.createPattern=function(t,n){},t.prototype.createRadialGradient=function(t,n,e,i,r,o){},t}(),c=function(){},h=function(){};function u(t){return void 0!==t.x}var p=function(){function t(t,n,e,i){this.vertices=[{x:t,y:n},{x:t+e,y:n},{x:t,y:n+i},{x:t+e,y:n+i}],this.left=t,this.right=t+e,this.top=n,this.bottom=n+i}return t.prototype.expandToInclude=function(n){var e,i,r,o;u(n)?(e=n.x,i=n.x,r=n.y,o=n.y):(e=n.left,i=n.right,r=n.top,o=n.bottom);var a=Math.min(e,this.left),s=Math.max(i,this.right),c=Math.min(r,this.top);return new t(a,c,s-a,Math.max(o,this.bottom)-c)},t.prototype.getInstructionToClear=function(){var t=this.left,n=this.top,e=this.right-this.left,i=this.bottom-this.top;return y.clearRect(t,n,e,i)},t.prototype.intersectWith=function(n){if(this.contains(n))return n;if(n.contains(this))return this;if(this.intersects(n)){var e=Math.max(this.top,n.top),i=Math.min(this.bottom,n.bottom),r=Math.max(this.left,n.left);return new t(r,e,Math.min(this.right,n.right)-r,i-e)}},t.prototype.transform=function(n){var e=this.vertices.map(function(t){return n.apply(t)}),i=e.map(function(t){return t.x}),r=e.map(function(t){return t.y}),o=Math.min.apply(Math,i),a=Math.min.apply(Math,r);return new t(o,a,Math.max.apply(Math,i)-o,Math.max.apply(Math,r)-a)},t.prototype.intersects=function(t){return this.left<=t.right&&this.right>=t.left&&this.bottom>=t.top&&this.top<=t.bottom},t.prototype.contains=function(t){return this.left<=t.left&&this.right>=t.right&&this.top<=t.top&&this.bottom>=t.bottom},t.create=function(n){return u(n)?new t(n.x,n.y,0,0):n},t}(),f=function(){function t(t){this.execute=t}return t.to=function(n){return new t(function(t,e){return n&&(n=u(n)?t.apply(n):n.transform(t)),e?n?e.expandToInclude(n):e:n?p.create(n):void 0})},t}();var l,y=function(){function t(){}return t.clearRect=function(t,n,e,i){return{instruction:function(r,o){var a=o.a,s=o.b,c=o.c,h=o.d,u=o.e,p=o.f;r.save(),r.setTransform(a,s,c,h,u,p),r.clearRect(t,n,e,i),r.restore()},changeArea:f.to(new p(t,n,e,i))}},t.arc=function(t,n,e,i,r,o){return{instruction:function(a,s){var c=s.getRotationAngle(),h=s.apply({x:t,y:n}),u=h.x,p=h.y;a.arc(u,p,e*s.scale,i+c,r+c,o)},changeArea:f.to(new p(t-e,n-e,2*e,2*e))}},t.arcTo=function(t,n,e,i,r){var o={x:t,y:n},a={x:e,y:i},s=p.create(o).expandToInclude(a);return{instruction:function(t,n){var e=n.apply(o),i=n.apply(a);t.arcTo(e.x,e.y,i.x,i.y,r*n.scale)},changeArea:f.to(s)}},t.bezierCurveTo=function(t,n,e,i,r,o){},t.closePath=function(){return{instruction:function(t,n){t.closePath()},changeArea:f.to()}},t.ellipse=function(t,n,e,i,o,a,s,c){var h=new p(t-e,n-i,2*e,2*i).transform(r.rotation(t,n,o));return{instruction:function(r,h){var u=h.apply({x:t,y:n}),p=h.getRotationAngle();r.ellipse(u.x,u.y,e*h.scale,i*h.scale,o+p,a,s,c)},changeArea:f.to(h)}},t.lineTo=function(t,n){var e={x:t,y:n};return{instruction:function(t,n){var i=n.apply(e),r=i.x,o=i.y;t.lineTo(r,o)},changeArea:f.to(e)}},t.moveTo=function(t,n){var e={x:t,y:n};return{instruction:function(t,n){var i=n.apply(e),r=i.x,o=i.y;t.moveTo(r,o)},changeArea:f.to(e)}},t.quadraticCurveTo=function(t,n,e,i){},t.rect=function(t,n,e,i){var r=new p(t,n,e,i);return{instruction:function(r,o){!function(t,n,e,i,r,o){var a,s,c,h,u,p,f;p=(a=o.apply({x:t,y:n})).x,f=a.y,r.moveTo(p,f),p=(s=o.apply({x:t+e,y:n})).x,f=s.y,r.lineTo(p,f),p=(c=o.apply({x:t+e,y:n+i})).x,f=c.y,r.lineTo(p,f),p=(h=o.apply({x:t,y:n+i})).x,f=h.y,r.lineTo(p,f),p=(u=o.apply({x:t,y:n})).x,f=u.y,r.lineTo(p,f)}(t,n,e,i,r,o)},changeArea:f.to(r)}},t}(),d=function(){function t(t){this.viewBox=t}return t.prototype.clearRect=function(t,n,e,i){this.viewBox.clearArea(t,n,e,i)},t.prototype.fillRect=function(t,n,e,i){this.viewBox.drawPath(function(t){return t.fill()},[y.rect(t,n,e,i)])},t.prototype.strokeRect=function(t,n,e,i){this.viewBox.drawPath(function(t){return t.stroke()},[y.rect(t,n,e,i)])},t}(),v=function(){function t(t){this.viewBox=t}return t.prototype.beginPath=function(){this.viewBox.beginPath()},t.prototype.clip=function(t,n){this.viewBox.clipPath(function(t){t.clip()})},t.prototype.fill=function(t,n){this.viewBox.drawPath(function(t){t.fill()})},t.prototype.isPointInPath=function(t,n,e,i){return!0},t.prototype.isPointInStroke=function(t,n,e){return!0},t.prototype.stroke=function(t){this.viewBox.drawPath(function(t){t.stroke()})},t}(),g=function(){function t(){}return t.prototype.drawFocusIfNeeded=function(t,n){},t.prototype.scrollPathIntoView=function(t){},t}(),S=function(){function t(){}return t.prototype.fillText=function(t,n,e,i){},t.prototype.measureText=function(t){},t.prototype.strokeText=function(t,n,e,i){},t}(),w=function(){function t(){}return t.prototype.drawImage=function(){var t=Array.prototype.slice.apply(arguments);if(arguments.length<=4){var n=t[0],e=t[1],i=t[2],r=t[3],o=t[4];this.drawImageWithoutSourceRect(n,e,i,r,o)}var a=t[0],s=t[1],c=t[2],h=t[3],u=t[4],p=t[5],f=t[6],l=t[7],y=t[8];this.drawImageFromSourceRect(a,s,c,h,u,p,f,l,y)},t.prototype.drawImageFromSourceRect=function(t,n,e,i,r,o,a,s,c){},t.prototype.drawImageWithoutSourceRect=function(t,n,e,i,r){},t}(),m=function(){function t(){}return t.prototype.createImageData=function(t,n){},t.prototype.getImageData=function(t,n,e,i){},t.prototype.putImageData=function(t,n,e,i,r,o,a){},t}(),P=function(){function t(t){this.viewBox=t}return Object.defineProperty(t.prototype,"lineDashOffset",{get:function(){return this.viewBox.state.current.lineDashOffset},set:function(t){this.viewBox.changeState(function(n){return n.setLineDashOffset(t)})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{get:function(){return this.viewBox.state.current.lineWidth},set:function(t){this.viewBox.changeState(function(n){return n.setLineWidth(t)})},enumerable:!0,configurable:!0}),t.prototype.getLineDash=function(){return this.viewBox.state.current.lineDash},t.prototype.setLineDash=function(t){this.viewBox.changeState(function(n){return n.setLineDash(t)})},t}(),b=function(){},I=function(){function t(t){this.viewBox=t}return t.prototype.arc=function(t,n,e,i,r,o){this.viewBox.addPathInstruction(y.arc(t,n,e,i,r,o))},t.prototype.arcTo=function(t,n,e,i,r){this.viewBox.addPathInstruction(y.arcTo(t,n,e,i,r))},t.prototype.bezierCurveTo=function(t,n,e,i,r,o){},t.prototype.closePath=function(){this.viewBox.addPathInstruction(y.closePath())},t.prototype.ellipse=function(t,n,e,i,r,o,a,s){this.viewBox.addPathInstruction(y.ellipse(t,n,e,i,r,o,a,s))},t.prototype.lineTo=function(t,n){this.viewBox.addPathInstruction(y.lineTo(t,n))},t.prototype.moveTo=function(t,n){this.viewBox.addPathInstruction(y.moveTo(t,n))},t.prototype.quadraticCurveTo=function(t,n,e,i){},t.prototype.rect=function(t,n,e,i){this.viewBox.addPathInstruction(y.rect(t,n,e,i))},t}(),x=function(){function t(t,n){this.canvas=t,this.canvasState=new i(n),this.canvasTransform=new o(n),this.canvasCompositing=new a,this.canvasStrokeStyles=new s(n),this.canvasShadowStyles=new c,this.canvasFilters=new h,this.canvasRect=new d(n),this.canvasDrawPath=new v(n),this.canvasUserInterface=new g,this.canvasText=new S,this.canvasDrawImage=new w,this.canvasImageData=new m,this.canvasPathDrawingStyles=new P(n),this.canvasTextDrawingStyles=new b,this.canvasPath=new I(n)}return t.prototype.save=function(){this.canvasState.save()},t.prototype.restore=function(){this.canvasState.restore()},t.prototype.getTransform=function(){return this.canvasTransform.getTransform()},t.prototype.resetTransform=function(){this.canvasTransform.resetTransform()},t.prototype.rotate=function(t){this.canvasTransform.rotate(t)},t.prototype.scale=function(t,n){this.canvasTransform.scale(t,n)},t.prototype.setTransform=function(t,n,e,i,r,o){this.canvasTransform.setTransform(t,n,e,i,r,o)},t.prototype.transform=function(t,n,e,i,r,o){this.canvasTransform.transform(t,n,e,i,r,o)},t.prototype.translate=function(t,n){this.canvasTransform.translate(t,n)},Object.defineProperty(t.prototype,"globalAlpha",{set:function(t){this.canvasCompositing.globalAlpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"globalCompositeOperation",{set:function(t){this.canvasCompositing.globalCompositeOperation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageSmoothingEnabled",{set:function(t){this.canvasImageSmoothing.imageSmoothingEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageSmoothingQuality",{set:function(t){this.canvasImageSmoothing.imageSmoothingQuality=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillStyle",{set:function(t){this.canvasStrokeStyles.fillStyle=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strokeStyle",{set:function(t){this.canvasStrokeStyles.strokeStyle=t},enumerable:!0,configurable:!0}),t.prototype.createLinearGradient=function(t,n,e,i){return this.canvasStrokeStyles.createLinearGradient(t,n,e,i)},t.prototype.createPattern=function(t,n){return this.canvasStrokeStyles.createPattern(t,n)},t.prototype.createRadialGradient=function(t,n,e,i,r,o){return this.canvasStrokeStyles.createRadialGradient(t,n,e,i,r,o)},Object.defineProperty(t.prototype,"shadowBlur",{set:function(t){this.canvasShadowStyles.shadowBlur=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowColor",{set:function(t){this.canvasShadowStyles.shadowColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowOffsetX",{set:function(t){this.canvasShadowStyles.shadowOffsetX=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowOffsetY",{set:function(t){this.canvasShadowStyles.shadowOffsetY=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filter",{set:function(t){this.canvasFilters.filter=t},enumerable:!0,configurable:!0}),t.prototype.clearRect=function(t,n,e,i){this.canvasRect.clearRect(t,n,e,i)},t.prototype.fillRect=function(t,n,e,i){this.canvasRect.fillRect(t,n,e,i)},t.prototype.strokeRect=function(t,n,e,i){this.canvasRect.strokeRect(t,n,e,i)},t.prototype.beginPath=function(){this.canvasDrawPath.beginPath()},t.prototype.clip=function(t,n){this.canvasDrawPath.clip(t,n)},t.prototype.fill=function(t,n){this.canvasDrawPath.fill(t,n)},t.prototype.isPointInPath=function(t,n,e,i){return this.canvasDrawPath.isPointInPath(t,n,e,i)},t.prototype.isPointInStroke=function(t,n,e){return this.canvasDrawPath.isPointInStroke(t,n,e)},t.prototype.stroke=function(t){this.canvasDrawPath.stroke(t)},t.prototype.drawFocusIfNeeded=function(t,n){this.canvasUserInterface.drawFocusIfNeeded(t,n)},t.prototype.scrollPathIntoView=function(t){this.canvasUserInterface.scrollPathIntoView(t)},t.prototype.fillText=function(t,n,e,i){this.canvasText.fillText(t,n,e,i)},t.prototype.measureText=function(t){return this.canvasText.measureText(t)},t.prototype.strokeText=function(t,n,e,i){this.canvasText.strokeText(t,n,e,i)},t.prototype.drawImage=function(){this.canvasDrawImage.drawImage.apply(this.canvasDrawImage,arguments)},t.prototype.createImageData=function(t,n){return this.canvasImageData.createImageData(t,n)},t.prototype.getImageData=function(t,n,e,i){return this.canvasImageData.getImageData(t,n,e,i)},t.prototype.putImageData=function(t,n,e,i,r,o,a){this.canvasImageData.putImageData(t,n,e,i,r,o,a)},Object.defineProperty(t.prototype,"lineCap",{set:function(t){this.canvasPathDrawingStyles.lineCap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineDashOffset",{set:function(t){this.canvasPathDrawingStyles.lineDashOffset=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{set:function(t){this.canvasPathDrawingStyles.lineJoin=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineWidth",{set:function(t){this.canvasPathDrawingStyles.lineWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{set:function(t){this.canvasPathDrawingStyles.miterLimit=t},enumerable:!0,configurable:!0}),t.prototype.getLineDash=function(){return this.canvasPathDrawingStyles.getLineDash()},t.prototype.setLineDash=function(t){this.canvasPathDrawingStyles.setLineDash(t)},Object.defineProperty(t.prototype,"direction",{set:function(t){this.canvasTextDrawingStyles.direction=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{set:function(t){this.canvasTextDrawingStyles.font=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textAlign",{set:function(t){this.canvasTextDrawingStyles.textAlign=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{set:function(t){this.canvasTextDrawingStyles.textBaseline=t},enumerable:!0,configurable:!0}),t.prototype.arc=function(t,n,e,i,r,o){this.canvasPath.arc(t,n,e,i,r,o)},t.prototype.arcTo=function(t,n,e,i,r){this.canvasPath.arcTo(t,n,e,i,r)},t.prototype.bezierCurveTo=function(t,n,e,i,r,o){this.canvasPath.bezierCurveTo(t,n,e,i,r,o)},t.prototype.closePath=function(){this.canvasPath.closePath()},t.prototype.ellipse=function(t,n,e,i,r,o,a,s){this.canvasPath.ellipse(t,n,e,i,r,o,a)},t.prototype.lineTo=function(t,n){this.canvasPath.lineTo(t,n)},t.prototype.moveTo=function(t,n){this.canvasPath.moveTo(t,n)},t.prototype.quadraticCurveTo=function(t,n,e,i){this.canvasPath.quadraticCurveTo(t,n,e,i)},t.prototype.rect=function(t,n,e,i){this.canvasPath.rect(t,n,e,i)},t}(),T=function(){function t(t){this.initiallyWithState=t,this.added=[]}return Object.defineProperty(t.prototype,"state",{get:function(){return this.currentlyWithState.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initialState",{get:function(){return this.initiallyWithState.initialState},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return this.added.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentlyWithState",{get:function(){return this.addedLast?this.addedLast:this.initiallyWithState},enumerable:!0,configurable:!0}),t.prototype.reconstructState=function(t,n){t.changeToState(n)},t.prototype.getAllInstructionsAndStates=function(){for(var t=this.initiallyWithState.getAllInstructionsAndStates(),n=0,e=this.added;n<e.length;n++){var i=e[n];t=t.concat(i.getAllInstructionsAndStates())}return t},t.prototype.addClippedPath=function(t){this.currentlyWithState.addClippedPath(t)},t.prototype.add=function(t){this.added.push(t),this.addedLast=t},t.prototype.removeAll=function(t){for(var n;(n=this.added.findIndex(t))>-1;)this.removeAtIndex(n)},t.prototype.contains=function(t){return!!this.added.find(t)},t.prototype.changeState=function(t){this.currentlyWithState.changeState(t)},t.prototype.saveState=function(){this.currentlyWithState.saveState()},t.prototype.restoreState=function(){this.currentlyWithState.restoreState()},t.prototype.changeToState=function(t){this.currentlyWithState.changeToState(t)},t.prototype.changeToStateWithClippedPaths=function(t){this.currentlyWithState.changeToStateWithClippedPaths(t)},t.prototype.setInitialState=function(t){this.initiallyWithState.setInitialState(t)},t.prototype.execute=function(t,n){this.initiallyWithState.execute(t,n);for(var e=0,i=this.added;e<i.length;e++){i[e].execute(t,n)}},t.prototype.beforeIndex=function(t){return 0===t?this.initiallyWithState:this.added[t-1]},t.prototype.stateAfterIndex=function(t){return this.added[t].state},t.prototype.removeAtIndex=function(t){t===this.added.length-1&&(1===this.added.length?this.addedLast=void 0:this.addedLast=this.added[t-1]),this.reconstructState(this.beforeIndex(t),this.stateAfterIndex(t)),this.added.splice(t,1)},t}(),C=function(){function t(t,n,e,i){this._initialState=t,this.initialInstruction=n,this.stateChangeInstruction=e,this.state=i||t,this.stateForInstruction=t}return t.prototype.change=function(t){this.changeToState(t(this.state).newState)},Object.defineProperty(t.prototype,"initialState",{get:function(){return this._initialState},enumerable:!0,configurable:!0}),t.prototype.addClippedPath=function(t){this.state=this.state.withClippedPath(t)},t.prototype.changeState=function(t){this.change(function(n){return n.withChangedState(t)})},t.prototype.getAllInstructionsAndStates=function(){return[{instruction:this.initialInstruction,state:this.stateForInstruction}]},t.prototype.saveState=function(){this.change(function(t){return t.save()})},t.prototype.restoreState=function(){this.change(function(t){return t.restore()})},t.prototype.changeToState=function(t){this.state=t,this.stateChangeInstruction=this.stateForInstruction.convertToState(this.state).instruction},t.prototype.changeToStateWithClippedPaths=function(t){this.state=t,this.stateChangeInstruction=this.stateForInstruction.convertToStateWithClippedPath(this.state).instruction},t.prototype.setInitialState=function(t){this.initialStateChangeInstruction=t.convertToState(this.stateForInstruction).instruction,this._initialState=t},t.prototype.execute=function(t,n){this.initialStateChangeInstruction&&this.initialStateChangeInstruction(t,n),this.initialInstruction&&this.initialInstruction(t,n),this.stateChangeInstruction&&this.stateChangeInstruction(t,n)},t}(),O=(l=function(t,n){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),A=function(t){function n(n,e,i,r,o,a){var s=t.call(this,n,e,o,a)||this;return s.drawsPath=i,s.clipsPath=r,s}return O(n,t),n.prototype.copy=function(){return new n(this.initialState,this.initialInstruction,this.drawsPath,this.clipsPath,this.stateChangeInstruction,this.state)},n}(C),W=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),D=function(t){function n(n,e,i,r){return t.call(this,n,e,i,r)||this}return W(n,t),n.prototype.copy=function(){return new n(this.initialState,this.initialInstruction,this.stateChangeInstruction,this.state)},n}(C),_=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),B=function(t){function n(n){return t.call(this,n)||this}return _(n,t),n.prototype.getCurrentlyDrawableArea=function(){if(this.area)return this.state.current.clippingRegion?this.state.current.clippingRegion.intersectWith(this.area):this.area},n.prototype.copy=function(){for(var t=new n(this.initiallyWithState.copy()),e=0,i=this.added;e<i.length;e++){var r=i[e];t.add(r.copy())}return t},n.prototype.drawPath=function(t){var n=this.getCurrentlyDrawableArea();this.drawnArea=this.drawnArea?this.drawnArea.expandToInclude(n):n,this.add(new A(this.state,t,!0,!1)),this.visible=!0},n.prototype.clipPath=function(t){this.add(new A(this.state,t,!0,!0));var n=this.recreateClippedPath();this.addClippedPath(n)},n.prototype.addPathInstruction=function(t){this.area=t.changeArea.execute(this.state.current.transformation,this.area),this.add(new A(this.state,t.instruction,!1,!1))},n.prototype.execute=function(n,e){this.visible&&t.prototype.execute.call(this,n,e)},n.prototype.hasDrawingAcrossBorderOf=function(t){return!(!this.drawnArea||!this.visible)&&(!t.contains(this.drawnArea)&&t.intersects(this.drawnArea))},n.prototype.isContainedBy=function(t){var n=this.drawnArea||this.area;return t.contains(n)},n.prototype.intersects=function(t){return!(!this.area||!this.visible)&&this.area.intersects(t)},n.prototype.getClippedArea=function(t){return t?this.area.intersectWith(t):this.area},n.prototype.clearContentsInsideArea=function(t){this.drawnArea&&this.visible&&t.contains(this.drawnArea)&&(this.visible=!1)},n.prototype.addClearRect=function(t){this.addPathInstruction(t.getInstructionToClear())},n.prototype.recreatePath=function(){var t=this.copy();return t.removeAll(function(t){return t.drawsPath}),t.area=this.area,t},n.prototype.recreateClippedPath=function(){var t=this.copy();return t.removeAll(function(t){return t.drawsPath&&!t.clipsPath}),t.area=this.area,t},n.create=function(t,e){var i=new n(new D(t,function(t){t.beginPath()}));if(!e)return i;for(var r=0,o=e;r<o.length;r++){var a=o[r];i.addPathInstruction(a)}return i},n}(T),k=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),j=function(t){function n(n){return t.call(this,n)||this}return k(n,t),n.create=function(t,e){return new n(new D(t,e))},n}(T),M=function(){function t(t,n,e){this.area=t,this.latestClippedPath=n,this.previouslyClippedPaths=e}return t.prototype.withClippedPath=function(n){return new t(n.getClippedArea(this.area),n,this)},t.prototype.getAllInstructionsAndStates=function(){for(var t=this.latestClippedPath.getAllInstructionsAndStates(),n=this.previouslyClippedPaths?this.previouslyClippedPaths.getAllInstructionsAndStates():[],e=[],i=function(t){e.find(function(n){return n.instruction===t.instruction})||e.push(t)},r=0,o=n.concat(t);r<o.length;r++){i(o[r])}return e},t.prototype.equals=function(t){return!!t&&(this.latestClippedPath===t.latestClippedPath&&(this.previouslyClippedPaths?this.previouslyClippedPaths.equals(t.previouslyClippedPaths):!t.previouslyClippedPaths))},t.prototype.contains=function(t){return!!t&&(!!this.equals(t)||!!this.previouslyClippedPaths&&this.previouslyClippedPaths.contains(t))},t.prototype.createFromInstructionsAndStates=function(t){for(var n,e=0,i=t;e<i.length;e++){var r=i[e];if(n){var o=new D(r.state,r.instruction);n.changeToState(o.initialState),n.add(o)}else n=j.create(r.state,r.instruction)}return n},t.prototype.recreate=function(){return this.createFromInstructionsAndStates(this.getAllInstructionsAndStates())},t.prototype.recreateStartingFrom=function(t){var n=t.getAllInstructionsAndStates(),e=this.getAllInstructionsAndStates().filter(function(t){return!n.find(function(n){return n.instruction===t.instruction})});return this.createFromInstructionsAndStates(e)},t}();function L(t,n){if(t.length!==n.length)return!1;for(var e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}var R=function(){function t(t,n){this.newState=t,this.instructions=n,n.length&&(this.instruction=function(t){return function(n,e){for(var i=0,r=t;i<r.length;i++){(0,r[i])(n,e)}}}(n))}return t.prototype.change=function(n){var e=n(this.newState);return e.instruction?new t(e.newState,this.instructions.concat([e.instruction])):new t(e.newState,this.instructions)},t}(),F=function(){function t(t,n,e,i,r,o,a){this.fillStyle=t,this.lineWidth=n,this.lineDash=e,this.strokeStyle=i,this.lineDashOffset=r,this.transformation=o,this.clippedPaths=a}return t.prototype.noStateChange=function(){return{newState:this,instruction:void 0}},Object.defineProperty(t.prototype,"clippingRegion",{get:function(){return this.clippedPaths?this.clippedPaths.area:void 0},enumerable:!0,configurable:!0}),t.prototype.equals=function(t){return this.fillStyle===t.fillStyle&&this.lineWidth===t.lineWidth&&L(this.lineDash,t.lineDash)&&this.strokeStyle===t.strokeStyle&&this.lineDashOffset===t.lineDashOffset&&this.transformation.equals(t.transformation)&&(!this.clippedPaths&&!t.clippedPaths||this.clippedPaths&&this.clippedPaths.equals(t.clippedPaths))},t.prototype.convertToState=function(t){var n=new R(this,[]).change(function(n){return n.setFillStyle(t.fillStyle)}).change(function(n){return n.setLineWidth(t.lineWidth)}).change(function(n){return n.setLineDash(t.lineDash)}).change(function(n){return n.setStrokeStyle(t.strokeStyle)}).change(function(n){return n.setLineDashOffset(t.lineDashOffset)}).change(function(n){return n.setTransformation(t.transformation)});return{newState:t,instruction:n.instruction}},t.prototype.withClippedPath=function(n){var e=this.clippedPaths?this.clippedPaths.withClippedPath(n):new M(n.getClippedArea(),n);return new t(this.fillStyle,this.lineWidth,this.lineDash,this.strokeStyle,this.lineDashOffset,this.transformation,e)},t.prototype.setFillStyle=function(n){return n===this.fillStyle?this.noStateChange():{newState:new t(n,this.lineWidth,this.lineDash,this.strokeStyle,this.lineDashOffset,this.transformation,this.clippedPaths),instruction:function(t,e){t.fillStyle=n}}},t.prototype.setLineWidth=function(n){return n===this.lineWidth?this.noStateChange():{newState:new t(this.fillStyle,n,this.lineDash,this.strokeStyle,this.lineDashOffset,this.transformation,this.clippedPaths),instruction:function(t,e){t.lineWidth=e.scale*n}}},t.prototype.setLineDash=function(n){return L(this.lineDash,n)?this.noStateChange():{newState:new t(this.fillStyle,this.lineWidth,n,this.strokeStyle,this.lineDashOffset,this.transformation,this.clippedPaths),instruction:function(t,e){t.setLineDash(n.map(function(t){return t*e.scale}))}}},t.prototype.setStrokeStyle=function(n){return this.strokeStyle===n?this.noStateChange():{newState:new t(this.fillStyle,this.lineWidth,this.lineDash,n,this.lineDashOffset,this.transformation,this.clippedPaths),instruction:function(t,e){t.strokeStyle=n}}},t.prototype.setLineDashOffset=function(n){return this.lineDashOffset===n?this.noStateChange():{newState:new t(this.fillStyle,this.lineWidth,this.lineDash,this.strokeStyle,n,this.transformation,this.clippedPaths),instruction:function(t,e){t.lineDashOffset=n*e.scale}}},t.prototype.addTransformation=function(n){if(n.equals(r.identity))return this.noStateChange();var e=n.before(this.transformation);return{newState:new t(this.fillStyle,this.lineWidth,this.lineDash,this.strokeStyle,this.lineDashOffset,e,this.clippedPaths),instruction:function(t,n){var i=n.inverse().before(e).before(n),r=i.a,o=i.b,a=i.c,s=i.d,c=i.e,h=i.f;t.setTransform(r,o,a,s,c,h)}}},t.prototype.setTransformation=function(n){return this.transformation.equals(n)?this.noStateChange():{newState:new t(this.fillStyle,this.lineWidth,this.lineDash,this.strokeStyle,this.lineDashOffset,n,this.clippedPaths),instruction:function(t,e){var i=e.inverse().before(n).before(e),r=i.a,o=i.b,a=i.c,s=i.d,c=i.e,h=i.f;t.setTransform(r,o,a,s,c,h)}}},t.default=new t("#000",1,[],"#000",0,r.identity,void 0),t.setDefault=function(t,n){t.lineWidth=n.scale},t}(),E=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),q=function(t){function n(n,e,i,r){var o=t.call(this,n,e.getInstructionToClear().instruction,i,r)||this;return o.area=e,o}return E(n,t),n.prototype.hasDrawingAcrossBorderOf=function(t){return!1},n.prototype.intersects=function(t){return this.area.intersects(t)},n.prototype.isContainedBy=function(t){return t.contains(this.area)},n}(C),G=function(){function t(t){this.initial=t,this.instructions=[],this.newState=t}return t.prototype.restore=function(){this.change(function(t){return t.restore()})},t.prototype.save=function(){this.change(function(t){return t.save()})},t.prototype.changeCurrentInstanceTo=function(t){this.newState.current.equals(t)||this.change(function(n){return n.withChangedState(function(n){return n.convertToState(t)})})},t.prototype.addChange=function(t){this.newState=t.newState,t.instruction&&this.instructions.push(t.instruction)},t.prototype.change=function(t){this.addChange(t(this.newState))},Object.defineProperty(t.prototype,"instruction",{get:function(){var t=this;if(0!==this.instructions.length)return function(n,e){for(var i=0,r=t.instructions;i<r.length;i++){(0,r[i])(n,e)}}},enumerable:!0,configurable:!0}),t}(),z=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),H=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return z(n,t),n.prototype.changeCurrentInstanceTo=function(e){if(!this.newState.current.equals(e))if(!n.canConvert(this.newState.current,e)&&this.newState.stack.length>0&&(this.restore(),this.save()),e.clippedPaths){var i=this.newState,r=i.current.clippedPaths;if(e.clippedPaths.equals(r))t.prototype.changeCurrentInstanceTo.call(this,e);else{var o=r?e.clippedPaths.recreateStartingFrom(r):e.clippedPaths.recreate();this.convertToState(o.initialState),this.addChange({newState:o.state,instruction:function(t,n){o.execute(t,n)}}),this.convertToState(i.replaceCurrent(e))}}else t.prototype.changeCurrentInstanceTo.call(this,e)},n.prototype.convertToState=function(t){this.change(function(n){return n.convertToState(t)})},n.canConvert=function(t,n){return!t.clippedPaths||!!n.clippedPaths&&n.clippedPaths.contains(t.clippedPaths)},n}(G),Y=new(function(){function t(t,n){void 0===n&&(n=[]),this.current=t,this.stack=n}return t.prototype.replaceCurrent=function(n){return new t(n,this.stack)},t.prototype.withChangedState=function(n){var e=n(this.current);return{newState:new t(e.newState,this.stack),instruction:e.instruction}},t.prototype.withClippedPath=function(n){return new t(this.current.withClippedPath(n),this.stack)},t.prototype.save=function(){return{newState:new t(this.current,(this.stack||[]).concat([this.current])),instruction:function(t){t.save()}}},t.prototype.lastBeforeFirstSaved=function(){return 0===this.stack.length?this:new t(this.stack[0])},t.prototype.restore=function(){return this.stack&&0!==this.stack.length?{newState:new t(this.stack[this.stack.length-1],this.stack.slice(0,this.stack.length-1)),instruction:function(t){t.restore()}}:{newState:this,instruction:void 0}},t.prototype.convertToLastSavedInstance=function(t,n){for(var e=this.stack.indexOf(n),i=this.stack.length-1;i>e;i--)t.restore()},t.prototype.convertFromLastSavedInstance=function(t,n){for(var e=this.stack.indexOf(n)+1;e<this.stack.length;e++)t.changeCurrentInstanceTo(this.stack[e]),t.save();t.changeCurrentInstanceTo(this.current)},t.prototype.convertToStateUsingConversion=function(n,e){var i=t.findIndexOfHighestCommon(this.stack,e.stack);return this.convertToLastSavedInstance(n,this.stack[i]),e.convertFromLastSavedInstance(n,e.stack[i]),n},t.prototype.convertToState=function(t){return this.convertToStateUsingConversion(new G(this),t)},t.prototype.convertToStateWithClippedPath=function(t){return this.convertToStateUsingConversion(new H(this),t)},t.findIndexOfHighestCommon=function(t,n){for(var e=0,i=Math.min(t.length-1,n.length-1);e<=i;){if(!t[e].equals(n[e]))return e-1;e++}return e-1},t}())(F.default,[]),X=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),U=function(t){function n(n){return t.call(this,n)||this}return X(n,t),n.prototype.reconstructState=function(t,n){t.changeToStateWithClippedPaths(n)},n.prototype.hasDrawingAcrossBorderOf=function(t){return this.contains(function(n){return n.hasDrawingAcrossBorderOf(t)})},n.prototype.intersects=function(t){return this.contains(function(n){return n.intersects(t)})},n.prototype.addClearRect=function(t){this.add(new q(this.state,t))},n.prototype.clearContentsInsideArea=function(t){this.removeAll(function(n){return n.isContainedBy(t)})},n.prototype.isContainedBy=function(t){return!this.contains(function(n){return!n.isContainedBy(t)})},n.create=function(){return new n(new D(Y,F.setDefault))},n}(T),V=function(){function t(t){this.onChange=t,this.previousInstructionsWithPath=U.create(),this.currentlyWithState=this.previousInstructionsWithPath}return Object.defineProperty(t.prototype,"state",{get:function(){return this.currentlyWithState.state},enumerable:!0,configurable:!0}),t.prototype.beginPath=function(){this.replaceCurrentInstructionsWithPath(B.create(this.state))},t.prototype.changeState=function(t){this.currentlyWithState.changeState(t),this.setInstructionToRestoreState()},t.prototype.saveState=function(){this.currentlyWithState.saveState(),this.setInstructionToRestoreState()},t.prototype.restoreState=function(){this.currentlyWithState.restoreState(),this.setInstructionToRestoreState()},t.prototype.drawPath=function(t,n){n?this.drawPathInstructions(n,t):this.drawCurrentPath(t),this.onChange()},t.prototype.clipPath=function(t){this.clipCurrentPath(t)},t.prototype.replaceCurrentInstructionsWithPath=function(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];this.currentInstructionsWithPath&&(this.currentInstructionsWithPath.visible?this.previousInstructionsWithPath.add(this.currentInstructionsWithPath):this.previousInstructionsWithPath.changeToStateWithClippedPaths(this.currentInstructionsWithPath.state));for(var i=0,r=n;i<r.length;i++){var o=r[i];this.previousInstructionsWithPath.add(o)}this.currentInstructionsWithPath=t,this.currentlyWithState=this.currentInstructionsWithPath,this.setInstructionToRestoreState()},t.prototype.drawCurrentPath=function(t){this.currentInstructionsWithPath&&(this.currentInstructionsWithPath.drawPath(t),this.setInstructionToRestoreState())},t.prototype.clipCurrentPath=function(t){this.currentInstructionsWithPath&&this.currentInstructionsWithPath.clipPath(t)},t.prototype.setInstructionToRestoreState=function(){var t=this.currentInstructionsWithPath&&this.currentInstructionsWithPath.visible?this.currentInstructionsWithPath.state:this.previousInstructionsWithPath.state;this.instructionToRestoreState=t.convertToState(t.lastBeforeFirstSaved()).instruction},t.prototype.drawPathInstructions=function(t,n){var e=B.create(this.state,t);if(e.drawPath(n),this.currentInstructionsWithPath){var i=this.currentInstructionsWithPath.recreatePath();i.setInitialState(this.state),this.replaceCurrentInstructionsWithPath(i,e)}else this.previousInstructionsWithPath.add(e)},t.prototype.addPathInstruction=function(t){this.currentInstructionsWithPath&&this.currentInstructionsWithPath.addPathInstruction(t)},t.prototype.intersects=function(t){return this.previousInstructionsWithPath.intersects(t)||this.currentInstructionsWithPath&&this.currentInstructionsWithPath.intersects(t)},t.prototype.hasDrawingAcrossBorderOf=function(t){return this.previousInstructionsWithPath.hasDrawingAcrossBorderOf(t)||this.currentInstructionsWithPath&&this.currentInstructionsWithPath.hasDrawingAcrossBorderOf(t)},t.prototype.clearContentsInsideArea=function(t){this.previousInstructionsWithPath.clearContentsInsideArea(t),this.currentInstructionsWithPath&&this.currentInstructionsWithPath.clearContentsInsideArea(t)},t.prototype.clearArea=function(t,n,e,i){var r=new p(t,n,e,i).transform(this.state.current.transformation);this.intersects(r)&&(this.clearContentsInsideArea(r),this.currentInstructionsWithPath&&this.currentInstructionsWithPath.hasDrawingAcrossBorderOf(r)?this.currentInstructionsWithPath.addClearRect(r):this.previousInstructionsWithPath.hasDrawingAcrossBorderOf(r)&&this.previousInstructionsWithPath.addClearRect(r),this.onChange())},t.prototype.execute=function(t,n){(this.previousInstructionsWithPath.length||this.currentInstructionsWithPath&&this.currentInstructionsWithPath.visible)&&this.previousInstructionsWithPath.execute(t,n),this.currentInstructionsWithPath&&this.currentInstructionsWithPath.execute(t,n),this.instructionToRestoreState&&this.instructionToRestoreState(t,n)},t}(),Z=function(){function t(t,n,e){var i=this;this.width=t,this.height=n,this.context=e,this.instructionSet=new V(function(){return i.draw()}),this._transformation=r.identity}return Object.defineProperty(t.prototype,"state",{get:function(){return this.instructionSet.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transformation",{get:function(){return this._transformation},set:function(t){this._transformation=t,this.draw()},enumerable:!0,configurable:!0}),t.prototype.changeState=function(t){this.instructionSet.changeState(t)},t.prototype.saveState=function(){this.instructionSet.saveState()},t.prototype.restoreState=function(){this.instructionSet.restoreState()},t.prototype.beginPath=function(){this.instructionSet.beginPath()},t.prototype.addPathInstruction=function(t){this.instructionSet.addPathInstruction(t)},t.prototype.drawPath=function(t,n){this.instructionSet.drawPath(t,n)},t.prototype.clipPath=function(t){this.instructionSet.clipPath(t)},t.prototype.clearArea=function(t,n,e,i){this.instructionSet.clearArea(t,n,e,i)},t.prototype.draw=function(){this.context.restore(),this.context.save(),this.context.clearRect(0,0,this.width,this.height),this.instructionSet.execute(this.context,this._transformation)},t}(),N=function(t,n){this.initial=t,this.cancel=n,this.current=t},J=function(){function t(t){this.point=t,this.handlers=[]}return t.prototype.removeHandler=function(t){var n=this.handlers.indexOf(t);return n>-1&&this.handlers.splice(n,1),this},t.prototype.moveTo=function(t,n){var e={x:t,y:n};this.point=e;for(var i=0,r=this.handlers;i<r.length;i++){(0,r[i])(e)}},t.prototype.onMoved=function(t){var n,e=this,i=function(e){n.current=e,t()};return this.handlers.push(i),n=new N(this.point,function(){return e.removeHandler(i)})},t}(),Q=function(){function t(t,n){var e=this;this.context=n,this.initialTransformation=n.transformation,this.point=t.onMoved(function(){e.setTransformation()})}return t.prototype.setTransformation=function(){this.context.transformation=this.initialTransformation.before(this.getTranslation())},t.prototype.getTranslation=function(){return r.translation(this.point.current.x-this.point.initial.x,this.point.current.y-this.point.initial.y)},t.prototype.withMovable=function(t){return this.context.getGestureForTwoMovables(this.point.cancel(),t)},t.prototype.withoutMovable=function(t){},t}(),K=function(){function t(t,n,e){var i=this;this.context=e,this.initialTransformation=e.transformation,this.point1=t.onMoved(function(){return i.setTransformation()}),this.point2=n.onMoved(function(){return i.setTransformation()})}return t.prototype.withMovable=function(t){},t.prototype.withoutMovable=function(t){var n=this.point1.cancel(),e=this.point2.cancel();return t===n?this.context.getGestureForOneMovable(e):t===e?this.context.getGestureForOneMovable(n):void 0},t}(),$=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),tt=function(t){function n(n,e,i){return t.call(this,n,e,i)||this}return $(n,t),n.prototype.setTransformation=function(){this.context.transformation=this.initialTransformation.before(r.translateZoom(this.point1.initial.x,this.point1.initial.y,this.point2.initial.x,this.point2.initial.y,this.point1.current.x,this.point1.current.y,this.point2.current.x,this.point2.current.y))},n}(K),nt=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),et=function(t){function n(n,e,i){return t.call(this,n,e,i)||this}return nt(n,t),n.prototype.setTransformation=function(){this.context.transformation=this.initialTransformation.before(r.translateRotateZoom(this.point1.initial.x,this.point1.initial.y,this.point2.initial.x,this.point2.initial.y,this.point1.current.x,this.point1.current.y,this.point2.current.x,this.point2.current.y))},n}(K),it=function(){function t(t,n){this.transformable=t,this.config=n}return Object.defineProperty(t.prototype,"transformation",{get:function(){return this.transformable.transformation},set:function(t){this.transformable.transformation=t},enumerable:!0,configurable:!0}),t.prototype.getGestureForOneMovable=function(t){return new Q(t,this)},t.prototype.getGestureForTwoMovables=function(t,n){return this.config.rotationEnabled?new et(t,n,this):new tt(t,n,this)},t}(),rt=function(){function t(t,n){var e=this;this.viewBox=n,this.initialTransformation=n.transformation,this.angularVelocity=4*Math.PI/n.width,this.point=t.onMoved(function(){e.setTransformation()})}return t.prototype.setTransformation=function(){this.viewBox.transformation=this.initialTransformation.before(r.rotation(this.point.initial.x,this.point.initial.y,(this.point.initial.x-this.point.current.x)*this.angularVelocity))},t.prototype.end=function(){this.point.cancel()},t}(),ot=function(){function t(t,n,e,i,r){this.transformable=t,this.centerX=n,this.centerY=e,this.onFinish=r,this.maxScaleLogStep=.1,this.initialTransformation=t.transformation,this.currentScaleLog=0,this.targetScaleLog=Math.log(i),this.makeStep()}return t.prototype.makeStep=function(){var t=this,n=this.targetScaleLog-this.currentScaleLog;Math.abs(n)<=this.maxScaleLogStep?(this.currentScaleLog+=n,this.setTransformToCurrentScaleLog(),this.onFinish()):(this.currentScaleLog+=n<0?-this.maxScaleLogStep:this.maxScaleLogStep,this.setTransformToCurrentScaleLog(),this.stepTimeout=setTimeout(function(){return t.makeStep()},20))},t.prototype.setTransformToCurrentScaleLog=function(){this.transformable.transformation=this.initialTransformation.before(r.zoom(this.centerX,this.centerY,Math.exp(this.currentScaleLog)))},t.prototype.cancel=function(){void 0!==this.stepTimeout&&clearTimeout(this.stepTimeout)},t}(),at=function(){function t(t,n){this.viewBox=t,this.context=new it(t,n)}return t.prototype.createAnchor=function(t){var n=this;return{moveTo:function(n,e){t.moveTo(n,e)},release:function(){n.gesture=n.gesture.withoutMovable(t)}}},t.prototype.zoom=function(t,n,e){var i=this;this._zoom&&this._zoom.cancel(),this._zoom=new ot(this.viewBox,t,n,e,function(){return i._zoom=void 0})},t.prototype.getAnchor=function(t,n){var e=new J({x:t,y:n});if(!this.gesture)return this.gesture=this.context.getGestureForOneMovable(e),this.createAnchor(e);var i=this.gesture.withMovable(e);return i?(this.gesture=i,this.createAnchor(e)):void 0},t.prototype.getRotationAnchor=function(t,n){var e=new J({x:t,y:n}),i=new rt(e,this.viewBox);return{moveTo:function(t,n){e.moveTo(t,n)},release:function(){i.end()}}},t}();var st=function(){function t(){this.latestIdentifier=0,this.records=[]}return t.prototype.addAnchor=function(t,n){var e=++this.latestIdentifier;return this.records.push({identifier:e,anchor:t,externalIdentifier:n}),e},t.prototype.getAnchorByIdentifier=function(t){var n=this.records.find(function(n){return n.identifier===t});if(n)return n.anchor},t.prototype.getAnchorByExternalIdentifier=function(t){var n=this.records.find(function(n){return n.externalIdentifier===t});if(n)return n.anchor},t.prototype.removeAnchorByIdentifier=function(t){var n=this.records.findIndex(function(n){return n.identifier===t});n>-1&&this.records.splice(n,1)},t.prototype.removeAnchorByExternalIdentifier=function(t){var n=this.records.findIndex(function(n){return n.externalIdentifier===t});n>-1&&this.records.splice(n,1)},t}();var ct=function(t,n,e,i){function r(n,e){var i=t.getBoundingClientRect();return{x:n-i.left,y:e-i.top}}this.anchorSet=new st,function(t,n,e,i,r){t.addEventListener("wheel",function(t){if(!r.greedyGestureHandling&&!t.ctrlKey)return!0;var e=i(t.clientX,t.clientY),o=e.x,a=e.y,s=t.deltaY,c=Math.pow(2,-s/300);return n.zoom(o,a,c),t.preventDefault(),!1})}(t,e,this.anchorSet,r,i),function(t,n,e,i,r){var o;function a(){void 0!==o&&(e.getAnchorByIdentifier(o).release(),e.removeAnchorByIdentifier(o),o=void 0)}t.addEventListener("mousedown",function(t){if(void 0===o){var a,s=i(t.clientX,t.clientY),c=s.x,h=s.y;if(1===t.button){if(!r.rotationEnabled)return!0;a=n.getRotationAnchor(c,h)}else a=n.getAnchor(c,h);return o=e.addAnchor(a),t.preventDefault(),!1}}),t.addEventListener("mousemove",function(t){if(void 0!==o){var n=i(t.clientX,t.clientY),r=n.x,a=n.y;e.getAnchorByIdentifier(o).moveTo(r,a)}}),t.addEventListener("mouseup",function(t){a()}),t.addEventListener("mouseleave",function(t){a()})}(t,e,this.anchorSet,r,i),function(t,n,e,i,r){t.addEventListener("touchstart",function(t){var o=t.touches;if(1===o.length&&!r.greedyGestureHandling)return!0;for(var a=0;a<o.length;a++){var s=o[a],c=s.identifier;if(!e.getAnchorByExternalIdentifier(c)){var h=i(s.clientX,s.clientY),u=h.x,p=h.y,f=n.getAnchor(u,p);e.addAnchor(f,c)}}return t.preventDefault(),!1}),t.addEventListener("touchmove",function(t){for(var n=t.changedTouches,r=0;r<n.length;r++){var o=n[r],a=e.getAnchorByExternalIdentifier(o.identifier);if(a){var s=i(o.clientX,o.clientY),c=s.x,h=s.y;a.moveTo(c,h)}}}),t.addEventListener("touchend",function(t){for(var n=t.changedTouches,i=0;i<n.length;i++){var r=n[i],o=e.getAnchorByExternalIdentifier(r.identifier);o&&(o.release(),e.removeAnchorByExternalIdentifier(r.identifier))}})}(t,e,this.anchorSet,r,i)};e.d(n,"InfiniteCanvas",function(){return ht});var ht=function(){function t(t,n){this.canvas=t,this.config=n||{rotationEnabled:!0,greedyGestureHandling:!1},this.viewBox=new Z(t.width,t.height,t.getContext("2d")),this.transformer=new at(this.viewBox,this.config);new ct(t,this.viewBox,this.transformer,this.config)}return t.prototype.getContext=function(){return this.context||(this.context=new x(this.canvas,this.viewBox)),this.context},Object.defineProperty(t.prototype,"rotationEnabled",{get:function(){return this.config.rotationEnabled},set:function(t){this.config.rotationEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"greedyGestureHandling",{get:function(){return this.config.greedyGestureHandling},set:function(t){this.config.greedyGestureHandling=t},enumerable:!0,configurable:!0}),t}()}]);